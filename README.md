# 幻境传说 (Fantasy Legend)

一款基于前后端分离架构的2D动作角色扮演游戏(ARPG)，前端使用Qt框架，后端使用C++实现核心游戏逻辑。

## 项目架构

本项目采用前后端分离架构，具有以下特点：

- **前端**：基于Qt/QML开发，专注于Windows平台，后续支持跨平台
- **后端**：C++实现的游戏核心逻辑，包括战斗系统、角色系统等
- **通信**：前后端通过定义好的协议进行数据交换
- **数据存储**：使用SQLite数据库进行数据持久化

## 目录结构

```
Fantasy_Legend/
├── client/                        # 前端目录
│   ├── assets/                   # 前端资源文件
│   │   ├── images/              # 图片资源
│   │   ├── audio/               # 音频资源
│   │   ├── ui/                  # UI资源(QML文件)
│   │   └── fonts/               # 字体资源
│   ├── include/                  # 前端头文件
│   │   ├── ui/                  # UI相关头文件
│   │   │   ├── windows/        # 窗口类
│   │   │   ├── scenes/         # 场景类
│   │   │   ├── components/     # UI组件
│   │   │   └── managers/       # UI管理器
│   │   ├── models/              # 前端数据模型
│   │   ├── controllers/         # 前端控制器
│   │   ├── network/             # 网络通信
│   │   └── utils/               # 工具类
│   ├── src/                      # 前端源代码
│   │   ├── main.cpp             # 程序入口
│   │   ├── ui/                  # UI实现
│   │   ├── models/              # 模型实现
│   │   ├── controllers/         # 控制器实现
│   │   ├── network/             # 网络实现
│   │   └── utils/               # 工具类实现
│   ├── config/                   # 前端配置文件
│   └── CMakeLists.txt            # 前端CMake配置
│
├── server/                        # 后端目录
│   ├── include/                  # 后端头文件
│   │   ├── core/                # 核心逻辑头文件
│   │   │   ├── characters/      # 角色系统
│   │   │   ├── combat/          # 战斗系统
│   │   │   ├── skills/          # 技能系统
│   │   │   ├── items/           # 物品系统
│   │   │   ├── quests/          # 任务系统
│   │   │   └── levels/          # 关卡系统
│   │   ├── data/                # 数据管理头文件
│   │   │   ├── database/        # 数据库管理
│   │   │   ├── config/          # 配置管理
│   │   │   └── save/            # 存档管理
│   │   ├── api/                 # API接口头文件
│   │   └── utils/               # 工具类头文件
│   ├── src/                      # 后端源代码
│   │   ├── main.cpp             # 后端入口
│   │   ├── core/                # 核心实现
│   │   ├── data/                # 数据实现
│   │   ├── api/                 # API实现
│   │   └── utils/               # 工具实现
│   ├── config/                   # 后端配置文件
│   ├── scripts/                  # 数据库脚本
│   └── CMakeLists.txt            # 后端CMake配置
│
├── common/                        # 前后端共享代码
│   ├── include/                  # 共享头文件
│   │   ├── protocol/            # 通信协议
│   │   ├── models/              # 共享数据模型
│   │   └── utils/               # 共享工具
│   ├── src/                      # 共享源代码
│   └── CMakeLists.txt            # 共享代码CMake配置
│
├── tools/                         # 开发工具
│   ├── python/                   # Python工具
│   │   ├── generators/          # 生成器
│   │   ├── database/            # 数据库工具
│   │   └── testing/             # 测试工具
│   ├── editors/                  # 编辑器工具
│   └── scripts/                  # 构建脚本
│
├── docs/                          # 文档
│   ├── api/                      # API文档
│   ├── design/                   # 设计文档
│   └── user/                     # 用户文档
│
├── tests/                         # 测试
│   ├── end_to_end/               # 端到端测试
│   └── performance/              # 性能测试
│
└── CMakeLists.txt                 # 主CMake配置
```

## 设计思路

### 前后端分离

本项目采用前后端分离的架构设计，主要基于以下考虑：

1. **职责分离**：前端专注于UI和用户交互，后端专注于游戏逻辑和数据处理
2. **开发效率**：前后端可以并行开发，提高开发效率
3. **可维护性**：代码结构清晰，易于维护和扩展
4. **跨平台支持**：前端可以针对不同平台进行优化，而后端逻辑保持不变

### 前端设计 (Qt)

前端基于Qt框架开发，主要包括以下模块：

1. **UI系统**：使用Qt Widgets和QML混合开发，实现游戏界面
2. **控制器**：处理用户输入和界面逻辑
3. **网络模块**：与后端通信，发送请求和接收响应
4. **资源管理**：加载和管理游戏资源（图片、音频等）

### 后端设计 (C++)

后端使用C++开发，实现游戏核心逻辑：

1. **核心系统**：
   - **角色系统**：角色属性、技能、装备等
   - **战斗系统**：战斗逻辑、伤害计算、连击系统等
   - **任务系统**：任务管理、进度跟踪等
   - **关卡系统**：关卡设计、地图管理等

2. **数据管理**：
   - **数据库系统**：使用SQLite存储游戏数据
   - **配置管理**：读取和管理游戏配置
   - **存档系统**：保存和加载游戏进度

3. **API接口**：提供给前端调用的接口，处理前端请求

### 通信协议

前后端通过定义好的协议进行通信，主要包括：

1. **消息格式**：JSON格式的消息，包含消息类型、数据等
2. **请求-响应模式**：前端发送请求，后端处理后返回响应
3. **事件通知**：后端主动向前端推送事件通知

## 核心系统

### 1. 战斗系统

- **混合战斗模式**：实时操作 + 策略思考
- **连击系统**：连续攻击提升伤害和效果
- **元素系统**：火、冰、雷、风、土、光、暗七种元素
- **状态系统**：增益、减益、控制效果

### 2. 角色系统

- **角色属性**：等级、经验、生命值、魔法值、攻击力、防御力等
- **技能系统**：主动技能、被动技能、技能树
- **装备系统**：武器、防具、饰品等

### 3. 数据库系统

- **核心表**：角色表、技能表、装备表、物品表、任务表、关卡表等
- **关联表**：角色技能关联、角色装备关联、角色背包等
- **记录表**：战斗记录、状态效果、游戏存档等

## 开发环境

- **操作系统**：Windows 10/11, Ubuntu 20.04+, macOS 12+
- **编译器**：MSVC 2019+, GCC 9+, Clang 10+
- **构建工具**：CMake 3.16+
- **依赖库**：
  - Qt 6.3+
  - Python 3.9+
  - pybind11
  - SQLite 3

## 构建与运行

### 构建前端

```bash
cd Fantasy_Legend
mkdir build_client && cd build_client
cmake ../client
make -j$(nproc)
```

### 构建后端

```bash
cd Fantasy_Legend
mkdir build_server && cd build_server
cmake ../server
make -j$(nproc)
```

### 运行

```bash
# 启动后端
./build_server/bin/FantasyLegend_Server

# 启动前端
./build_client/bin/FantasyLegend_Client
```

## 开发计划

1. **第一阶段**：基础框架搭建
   - 前后端基础结构
   - 核心系统原型
   - 基础UI框架

2. **第二阶段**：核心功能开发
   - 战斗系统
   - 角色系统
   - 任务系统
   - 关卡系统

3. **第三阶段**：内容制作
   - 主线剧情
   - 支线任务
   - 角色和装备
   - 关卡和世界

4. **第四阶段**：优化和测试
   - 性能优化
   - 游戏平衡
   - 测试和修复

## 贡献指南

1. Fork 本仓库
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 创建 Pull Request 